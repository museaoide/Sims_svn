ybar
apply(ygivenx, 1, sum)
murf
match.call()
y[1:6, ]
0
Q
system.time(fpoutcapm4a6g32 <- DiscFP(paramc8, gcapm, ycapm, Ucapm, xfcnCapm, alph=6, crit=1e-5, nit=10000, murf=.02))
system.time(fpoutcapm4a6g32 <- DiscFP(paramc8, gcapm, ycapm, Ucapm, xfcnCapm, alph=6, crit=1e-5, nit=10000, murf=.02))
paramc8
paramc8 <- paramc8[-9]
system.time(fpoutcapm4a6g32 <- DiscFP(paramc8, gcapm, ycapm, Ucapm, xfcnCapm, alph=6, crit=1e-5, nit=10000, murf=.02))
fpoutcapm4a6g32$x
fpoutcapm4a10g3m2$x
system.time(fpoutcapm8a10g3m2 <- DiscFP(paramc8, gcapm, ycapm, Ucapm, xfcnCapm, alph=10, crit=1e-5, nit=10000, murf=.02))
plot(fpoutcapm8a10g3m2$x)
help.start()
plot(fpoutcapm8a10g3m2$x, pch=as.character(1:8))
system.time(fpoutcapm8a10g3m2 <- DiscFP(with(fpoutcapm8a10g3m2, c(8, Dout$pnew[-8], x)), gcapm, ycapm, Ucapm, xfcnCapm, alph=10, crit=1e-5, nit=10000, murf=.02))
plot(fpoutcapm8a10g3m2$x, pch=as.character(1:8))
paramc8
paramc8 <- with(fpoutcapm8a10g3m2, c(8, Dout$pnew[-8], x))
paramc8
paramc8[c(9, 13)] <- 19.38
paramc8
paramc8 <- with(fpoutcapm8a10g3m2, c(8, Dout$pnew[-8], x))
paramc8[c(9, 21)] <- 19.38
paramc8[c(17,13)] <- -13.67
p <- .5 * (paramc8[10, 18] + paramc8[24, 16])
p <- .5 * (paramc8[c(10, 18)] + paramc8[c(24, 16)])
paramc8[c(20,18)] <- p
paramc8[c(24, 16)] <- p
paramc8[3] <- paramc8[3] + .055
paramc8[c(2,6)] <- mean(paramc8[c(2,6)])
p <- .5 * (paramc8[c(4,12)] + paramc8[c(15, 7)])
paramc8[c(2,6)] <- p
paramc8[c(15,7)] <- p
pairs <- matrix(c(1,5, 2,8, 3,4), ncol=2, byrow=TRUE)
p <- fpoutcapm8a10g3m2$x
for (ix in 1:3) { pm <- (p[pairs[ix,1], ] + p[pairs[ix, 2], 2:1])/2
p[pairs[ix,1] <- pm
p[pairs[ix, 2] <- pm]]
for (ix in 1:3) { pm <- (p[pairs[ix,1], ] + p[pairs[ix, 2], 2:1])/2
p[pairs[ix,1], ] <- pm
p[pairs[ix,1], 2:1] <- pm
}
p
pairs
p <- fpoutcapm8a10g3m2$x
for (ix in 1:3) { pm <- (p[pairs[ix,1], ] + p[pairs[ix, 2], 2:1])/2
p[pairs[ix,1], ] <- pm
p[pairs[ix,2], 2:1] <- pm
}
p
p[7, ] <- mean(p[7, ]
p
p[7, ] <- mean(p[7, ])
p
pn <- fpoutcapm8a10g3m2$Dout$pnew
pn
for (ix in 1:3) pn[pairs[ix, ]] <- mean(pn[piars[ix, ]])
for (ix in 1:3) pn[pairs[ix, ]] <- mean(pn[pairs[ix, ]])
for (ix in 1:3) pn[pairs[ix, ]] <- mean(pn[pairs[ix, ]])
pn
p[6, ] <- p[2, ]
p[6, ] <- p[3, ]
pn
pn[3,4] <- .316
pn[c(3,4)] <- .316
pn[6] <- .001
system.time(fpoutcapm8a10g3m2x <- DiscFP(c(8, pn[-8], p), gcapm, ycapm, Ucapm, xfcnCapm, alph=10, crit=1e-5, nit=1000, murf=.02))
plot(fpoutcapm8a10g3m2x$x, pch=as.character(1:8))
sum(fpoutcapm8a10g3m2x$Dout$pnew[-c(1,5,7)])
system.time(fpoutcapm8a10g3m2x <- DiscFP(c(8, pn[-8], p), gcapm, ycapm, Ucapm, xfcnCapm, alph=10, crit=1e-5, nit=10000, murf=.02))
x <- fpoutcapm8a10g3m2$x
p <- fpoutcapm8a10g3m2$Dout$pnew
o  <- fpoutcapm8a10g3m2$Dout$obj
x
p
o
print(o, digits=10)
x <- fpoutcapm8a10g3m2x$x
p <- fpoutcapm8a10g3m2x$Dout$pnew
o  <- fpoutcapm8a10g3m2x$Dout$obj
x
p
o
print(o, digits=10)
plot(fpoutcapm8a10g3m2x$x, pch=as.character(1:8))
system.time(fpoutcapm8a10g3m2x <- DiscFP(with(fpoutcapm8A10g3m2x, c(Dout$pnew[c(1:5)],0,pnew[c(7,8)], x)), gcapm, ycapm, Ucapm, xfcnCapm, alph=10, crit=1e-5, nit=10000, murf=.02))
system.time(fpoutcapm8a10g3m2x <- DiscFP(with(fpoutcapm8a10g3m2x, c(Dout$pnew[c(1:5)],0,pnew[c(7,8)], x)), gcapm, ycapm, Ucapm, xfcnCapm, alph=10, crit=1e-5, nit=10000, murf=.02))
system.time(fpoutcapm8a10g3m2x <- DiscFP(with(fpoutcapm8a10g3m2x, c(Dout$pnew[c(1:5)],0,pnew[c(7,8)], x)), gcapm, ycapm, Ucapm, xfcnCapm, alph=10, crit=1e-5, nit=10000, murf=.02))
system.time(fpoutcapm8a10g3m2x <- DiscFP(with(fpoutcapm8a10g3m2x, c(Dout$pnew[c(1:5)],0,Dout$pnew[c(7,8)], x)), gcapm, ycapm, Ucapm, xfcnCapm, alph=10, crit=1e-5, nit=10000, murf=.02))
system.time(fpoutcapm8a10g3m2x <- DiscFP(with(fpoutcapm8a10g3m2x, c(Dout$pnew[c(1:5)],0,Dout$pnew[7], x)), gcapm, ycapm, Ucapm, xfcnCapm, alph=10, crit=1e-5, nit=10000, murf=.02))
system.time(fpoutcapm8a10g3m2x <- DiscFP(with(fpoutcapm8a10g3m2x, c(Dout$pnew[8, c(1:5)],0,Dout$pnew[7], x)), gcapm, ycapm, Ucapm, xfcnCapm, alph=10, crit=1e-5, nit=10000, murf=.02))
system.time(fpoutcapm8a10g3m2x <- DiscFP(with(fpoutcapm8a10g3m2x, c(8, Dout$pnew[1:5],0,Dout$pnew[7], x)), gcapm, ycapm, Ucapm, xfcnCapm, alph=10, crit=1e-5, nit=10000, murf=.02)
}
system.time(fpoutcapm8a10g3m2x <- DiscFP(with(fpoutcapm8a10g3m2x, c(8, Dout$pnew[1:5],0,Dout$pnew[7], x)), gcapm, ycapm, Ucapm, xfcnCapm, alph=10, crit=1e-5, nit=10000, murf=.02))
system.time(fpoutcapm8a10g3m2x <- DiscFP(with(fpoutcapm8a10g3m2x, c(8, Dout$pnew[1:5],1e-7,Dout$pnew[7], x)), gcapm, ycapm, Ucapm, xfcnCapm, alph=10, crit=1e-5, nit=10000, murf=.02))
system.time(fpoutcapm8a10g3m2x <- DiscFP(with(fpoutcapm8a10g3m2x, c(8, Dout$pnew[1:5],1e-7,Dout$pnew[7], x)), gcapm, ycapm, Ucapm, xfcnCapm, alph=10, crit=1e-5, nit=10000, murf=.02))
plot(fpoutcapm8a10g3m2x$x, pch=as.character(1:8))
plot(fpoutcapm8a10g3m2x$x[-6,], pch=as.character((1:8)[-6]))
plot(fpoutcapm8a10g3m2x$x[-6,], pch=x, cex=3)
plot(fpoutcapm8a10g3m2x$x[-6,], pch="x", cex=3)
plot(fpoutcapm8a10g3m2x$x[-6,], pch=1:8, cex=3)
plot(fpoutcapm8a10g3m2x$x[-6,], pch=3, cex=3, bg="red")
plot(fpoutcapm8a10g3m2x$x[-6,], pch=3, cex=4, bg="red")
plot(fpoutcapm8a10g3m2x$x[-6,], pch=4, cex=3, fill="red")
plot(fpoutcapm8a10g3m2x$x[-6,], pch=4, cex=3, bg="red")
plot(fpoutcapm8a10g3m2x$x[-6,], pch=5, cex=3)
plot(fpoutcapm8a10g3m2x$x[-6,], pch=6, cex=3)
library(xtable)
xtable(with(fpoutcapm8a10g3m2x$x, cbind(x, Dout$pnew)))
xtable(with(fpoutcapm8a10g3m2x$, cbind(x, Dout$pnew)))
xtable(with(fpoutcapm8a10g3m2x$, cbind(x, Dout$pnew)))
xtable(with(fpoutcapm8a10g3m2x, cbind(x, Dout$pnew)))
xtable(with(fpoutcapm8a10g3m2x, cbind(x[-6. ], Dout$pnew[-6])))
xtable(with(fpoutcapm8a10g3m2x, cbind(x[-6, ], Dout$pnew[-6])))
xtable(with(fpoutcapm8a10g3m2x, cbind(x[c(1,5,2,7,3,4), ], Dout$pnew[c(1,5,2,7,3,4)])))
paramc8 <- with(fpoutcapm8a10g3m2x, c(8, Dout$pnew[-8], x))
paramc8
paramc8[3] <- with(fpoutcapm8a10g3m2x$Dout, (pnew[2] + pnew[8])/2)
paramc8
system.time(fpoutcapm8a10g3m2x <- DiscFP(paramc8, gcapm, ycapm, Ucapm, xfcnCapm, alph=10, crit=1e-5, nit=1000, murf=.02))
xtable(with(fpoutcapm8a10g3m2x, cbind(Dout$pnew[-6], x[-6, ])))
xtable(with(fpoutcapm8a10g3m2x, cbind(Dout$pnew[c(3,4,2,8, 1,5, 7)], x[c(3,4,2,8, 1,5, 7), ])))
ls(pattern="fpoutcapm")
with(fpoutcapm4a4g3x, cbind(Dout$pnew, x))
with(fpoutcapm4a4g3, cbind(Dout$pnew, x))
with(fpoutcapm4a4g3, cbind(Dout$pnew, x))
with(fpoutcapm4a6g32, cbind(Dout$pnew, x))
with(fpoutcapm4a6g32, call)
with(fpoutcapm4a6g3, cbind(Dout$pnew, x))
with(fpoutcapm4a6g3x, cbind(Dout$pnew, x))
with(fpoutcapm4a6g3x, call)
with(fpoutcapm4a6g3, call)
with(fpoutcapm8a2, call)
with(fpoutcapm8a3, call)
with(fpoutcapm8a2, cbind(Dout$pnew, x))
with(fpoutcapm8a3, cbind(Dout$pnew, x))
plot(fpoutcapm8a3$x )
print(fpoutcapm8a3$Dout$obj, digits=10)
print(fpoutcapm4a3g3$Dout$obj, digits=10)
system.time(fpoutcapm8a6g3m3 <- DiscFP(c(8, , gcapm, ycapm, Ucapm, xfcnCapm, alph=10, crit=1e-5, nit=1000, murf=.03)}
paramc8
paramc8ru <- runif(8)
paramc8ru <- paramc8ru/sum(paramc8ru)
paramc8ru <- c(8, paramc8ru[-8], (runif(16)-.5)*20)
system.time(fpoutcapm8a6g3m3 <- DiscFP(paramc8ru,gcapm, ycapm, Ucapm, xfcnCapm, alph=10, crit=1e-5, nit=1000, murf=.03))
system.time(fpoutcapm8a6g3m3 <- DiscFP(with(fpoutcapm8a6g3m3, c(8, Dout$pnew[-8], x)),gcapm, ycapm, Ucapm, xfcnCapm, alph=10, crit=1e-5, nit=10000, murf=.03))
enableJIT(2)
library(compiler)
enableJIT(2)
system.time(fpoutcapm8a6g3m3 <- DiscFP(with(fpoutcapm8a6g3m3, c(8, Dout$pnew[-8], x)),gcapm, ycapm, Ucapm, xfcnCapm, alph=10, crit=1e-5, nit=10000, murf=.03))
system.time(fpoutcapm8a6g3m3 <- DiscFP(with(fpoutcapm8a6g3m3, c(8, Dout$pnew[-8], x)),gcapm, ycapm, Ucapm, xfcnCapm, alph=10, crit=1e-5, nit=10000, murf=.03))
paramc8circle <- c(8, rep(.125,7), 20 * sin(2 * pi * 1:8/8), 20 * cos(2*pi * 1:8/8))
paramc8circle
system.time(fpoutcapm8a6g3m3o <- DiscFP(paramc8circle,gcapm, ycapm, Ucapm, xfcnCapm, alph=10, crit=1e-5, nit=1000, murf=.03))
system.time(fpoutcapm8a6g3m3o <- DiscFP(paramc8circle,gcapm, ycapm, Ucapm, xfcnCapm, alph=10, crit=1e-5, nit=10000, murf=.03))
plot(fpoutcapm8a6g3m3o$x, pch=as.character(1:8))
paramc10circle <- c(8, rep(.1,9), 20 * sin(2 * pi * 1:10/10), 20 * cos(2*pi * 1:10/10))
system.time(fpoutcapm10a6g3m3o <- DiscFP(paramc10circle,gcapm, ycapm, Ucapm, xfcnCapm, alph=10, crit=1e-5, nit=10000, murf=.03))
paramc10circle <- c(10, rep(.1,9), 20 * sin(2 * pi * 1:10/10), 20 * cos(2*pi * 1:10/10))
system.time(fpoutcapm10a6g3m3o <- DiscFP(paramc10circle,gcapm, ycapm, Ucapm, xfcnCapm, alph=10, crit=1e-5, nit=10000, murf=.03))
0
paramc10ru <- runif(10)
paramc8ru <- paramc8ru/sum(paramc8ru)
paramc10ru <- paramc10ru/sum(paramc10ru)
paramc10ru <- c(8, paramcruru[-10], (runif(20)-.5)*20)
paramc10ru <- c(8, paramc10ru[-10], (runif(20)-.5)*20)
system.time(fpoutcapm10a6g3m3u <- DiscFP(paramc10ru, gcapm, ycapm, Ucapm, xfcnCapm, alph=6, crit=1e-5, nit=10000, murf=.03))
paramc10ru <- c(10, paramc10ru[-10], (runif(20)-.5)*20)
system.time(fpoutcapm10a6g3m3u <- DiscFP(paramc10ru, gcapm, ycapm, Ucapm, xfcnCapm, alph=6, crit=1e-5, nit=10000, murf=.03))
: 0
paramc10ru
paramc10ru <- runif(10)
paramc10ru <-paramc10ru/sum(pramc10ru)
paramc10ru <-paramc10ru/sum(paramc10ru)
paramc10ru <- c(10, paramc10ru[-10], (runif(10) - .5 ) * 20)
system.time(fpoutcapm10a6g3m3u <- DiscFP(paramc10ru, gcapm, ycapm, Ucapm, xfcnCapm, alph=6, crit=1e-5, nit=10000, murf=.03))
paramc10ru <- runif(10)
paramc10ru <-paramc10ru/sum(paramc10ru)
paramc10ru <- c(10, paramc10ru[-10], (runif(20) - .5 ) * 20)
system.time(fpoutcapm10a6g3m3u <- DiscFP(paramc10ru, gcapm, ycapm, Ucapm, xfcnCapm, alph=6, crit=1e-5, nit=10000, murf=.03))
system.time(fpoutcapm10a6g3m3u <- DiscFP(paramc10ru, gcapm, ycapm, Ucapm, xfcnCapm, alph=6, crit=1e-5, nit=10000, murf=.03))
plot(fpoutcapm8a3$x )
plot(fpoutcapm10a6g3m3u$x)
print(fpoutcapm10a6g3m3u$Dout$obj, digits=10)
print(fpoutcapm10a6g3m3$Dout$obj, digits=10)
ls(pattern="fpout")
print(fpoutcapm8a6g3m3o$Dout$obj, digits=10)
fpoutcapm8a6g3m3o$Dout$call
fpoutcapm8a6g3m3o$call
fpoutcapm8a10g3m3o <- fpoutcapm8a6g3m3o
rm(fpoutcapm8a6g3m3o)
print(fpoutcapm4a6g3m3o$Dout$obj, digits=10)
0
print(fpoutcapm8a6g3m3o$Dout$obj, digits=10)
print(fpoutcapm8a6g3m3$Dout$obj, digits=10)
fpoutcapm8a6g3m3$Dout$call
fpoutcapm8a6g3m3$call
fpoutcapm8a10g3m3 <- fpoutcapm8a6g3m3
str(fpoutcapm8a10g3m3)
print(fpoutcapm4a6g3$Dout$obj, digits=10)
print(fpoutcapm4a6g3x$Dout$obj, digits=10)
ls(pattern="fpout")
print(fpoutcapm10a6g3m3u$Dout$obj, digits=10)
print(fpoutcapm8a10g3m3$Dout$obj, digits=10)
print(fpoutcapm8a10g3m3o$Dout$obj, digits=10)
plot(fpoutcapm8a10g3m3o$x)
apply(fpoutcapm8a10g3m3o$x, 1, norm)
apply(fpoutcapm8a10g3m3o$x, 1, norm)
fpoutcapm8a10g3m3o$x
apply(fpoutcapm8a10g3m3o$x, 1, function(z) sqrt(sum(z^2)))
apply(fpoutcapm8a10g3m3o$x, 1, atan2)
apply(fpoutcapm8a10g3m3o$x, 1, function(x) atan2(x[1],x[2])
apply(fpoutcapm8a10g3m3o$x, 1, function(x) atan2(x[1],x[2])
)
diff(.Last.value)
apply(fpoutcapm8a10g3m3o$x, 1, function(x) atan2(x[1],x[2])
)
.Last.value
diff(.Last.value)
print(fpoutcapm10a6g3m3u$Dout$obj, digits=10)
fpoutcapm10a6g3m3u$x
fpoutcapm10a6g3m3u$call
system.time(fpoutcapm10a10g3m3u <- DiscFP(paramc10ru, gcapm, ycapm, Ucapm, xfcnCapm, alph=10, crit=1e-5, nit=10000, murf=.03))
plot(fpoutcapm10a10g3m3u$x)
fpoutcapm10a10g3m3u$call
fpoutcapm4a4g3$x
fpoutcapm4a6g3$x
fpoutcapm4a6g3x$x
print(fpoutcapm4a6g3x$$Dout$obj, digits=10)
print(fpoutcapm4a6g3x$Dout$obj, digits=10)
print(fpoutcapm4a6g3$Dout$obj, digits=10)
print(fpoutcapm8a6g3$Dout$obj, digits=10)
fpoutcapm4a6g3$call
print(fpoutcapm8a6g3m3$Dout$obj, digits=10)
fpoutcapm8a6g3m3$call
identical(fpoutcapm10a6g3m3, fpoutcapm10a10g3m3)
fpoutcapm10a6g3m3$x
fpoutcapm8a6g3m3$x
fpoutcapm8a10g3m3$x
identical(fpoutcapm8a6g3m3, fpoutcapm8a10g3m3)
rm(fpoutcapm8a6g3m3)
ls(pattern="fpout")
fpoutcapm4a5g32$x
fpoutcapm4a6g32$x
fpoutcapm4a6g3$x
fpoutcapm4a6g3$call
fpoutcapm4a5g32$call
fpoutcapm4a6g32$call
system.time(fpoutcapm8a6g3m3u <- DiscFP(c(8, 1:7/8, (runif(16)-.5) * 20), gcapm, ycapm, Ucapm, xfcnCapm, alph=6, crit=1e-5, nit=1000, murf=.03))
0
system.time(fpoutcapm8a6g3m3u <- DiscFP(c(8, 1:7/36, (runif(16)-.5) * 20), gcapm, ycapm, Ucapm, xfcnCapm, alph=6, crit=1e-5, nit=1000, murf=.03))
system.time(fpoutcapm8a6g3m3u <- DiscFP(with(fpoutcapm8a6g3m3u, c(8, Dout$pnew[-8], x)), gcapm, ycapm, Ucapm, xfcnCapm, alph=6, crit=1e-5, nit=1000, murf=.03))
plot(fpoutcapm8a6g3m3u$x)
system.time(fpoutcapm8a6g3m3u <- DiscFP(with(fpoutcapm8a6g3m3u, c(8, Dout$pnew[-8], x)), gcapm, ycapm, Ucapm, xfcnCapm, alph=6, crit=1e-5, nit=1000, murf=.03))
system.time(fpoutcapm8a6g3m3u <- DiscFP(with(fpoutcapm8a6g3m3u, c(8, Dout$pnew[-8], x)), gcapm, ycapm, Ucapm, xfcnCapm, alph=6, crit=1e-5, nit=1000, murf=.03))
plot(fpoutcapm8a6g3m3u$x)
system.time(fpoutcapm8a6g3m3u <- DiscFP(with(fpoutcapm8a6g3m3u, c(8, Dout$pnew[-8], x)), gcapm, ycapm, Ucapm, xfcnCapm, alph=6, crit=1e-5, nit=1000, murf=.03))
points(fpoutcapm8a6g3m3u$x, col="red")
system.time(fpoutcapm8a6g3m3u <- DiscFP(with(fpoutcapm8a6g3m3u, c(8, Dout$pnew[-8], x)), gcapm, ycapm, Ucapm, xfcnCapm, alph=6, crit=1e-5, nit=1000, murf=.03))
points(fpoutcapm8a6g3m3u$x, col="blue")
fpoutcapm4a6g3m3x$x)
ls(pattern="fpoutcapm8a6")
ls(pattern="fpoutcapm4a6")
fpoutcapm4a6g3x$x
xtable(fpoutcapm4a6g3x$x, digits=4)
fpoutcapm4a6g3x$Dout$pnew
ls(pattern="m2")
ls(pattern="m3")
fpoutcapm10a10g3m3u$Dout$obj
fpoutcapm8a10g3m3u$Dout$obj
fpoutcapm8a10g3m3$Dout$obj
plot(fpoutcapm10a10g3m3u$x)
points(fpoutcapm8a10g3m3$x, col="red")
str(fpoutcapm8a10g3m3)
fpoutcapm8a10g3m3$x
fpoutcapm8a10g3m3$Dout$pnew
points(fpoutcapm8a10g3m3$x[c(2,3,4,6,8), ], pch="+")
fpoutcapm8a6g3m3o$Dout$obj
fpoutcapm8a10g3m3o$Dout$obj
points(fpoutcapm10a10g3m3u$x, pch="x")
plot(fpoutcapm8a10g3m3o$x)
ls(pattern="m3o")
str(fpoutcapm8a10g3m3o)
apply(fpoutcapm8a10g3m3o$x, 2, function(x) <- sum(x^2))
apply(fpoutcapm8a10g3m3o$x, 2, function(x) sum(x^2))
apply(fpoutcapm8a10g3m3o$x, 1, function(x) sum(x^2))
fpoutcapm8a10g3m3o$x
ls(pattern="fpoutcapm")
print(fpoutcapm8a10g3m2$Dout$obj, digits=10)
print(fpoutcapm8a10g3m2x$Dout$obj, digits=10)
plot(fpoutcapm8a10g3m2x$x)
contour(with(fpoutcapm8a10g3m2x, ycapm[1:41, ], ycapm[1:41, ], matrix(Dout$ygivenx[1, ], 41,41)))
contour(with(fpoutcapm8a10g3m2x, ycapm[1:41, ], ycapm[1:41, ], matrix(Dout$ygivenx[2, ], 41,41)), add=TRUE, col=2)
ix <- 3
contour(with(fpoutcapm8a10g3m2x, ycapm[1:41, ], ycapm[1:41, ], matrix(Dout$ygivenx[ix, ], 41,41)), add=TRUE, col=ix)
ix <- 4
contour(with(fpoutcapm8a10g3m2x, ycapm[1:41, ], ycapm[1:41, ], matrix(Dout$ygivenx[ix, ], 41,41)), add=TRUE, col=ix)
ix <- 5
contour(with(fpoutcapm8a10g3m2x, ycapm[1:41, ], ycapm[1:41, ], matrix(Dout$ygivenx[ix, ], 41,41)), add=TRUE, col=ix)
ix <-6
contour(with(fpoutcapm8a10g3m2x, ycapm[1:41, ], ycapm[1:41, ], matrix(Dout$ygivenx[ix, ], 41,41)), add=TRUE, col=ix)
ix <-7
contour(with(fpoutcapm8a10g3m2x, ycapm[1:41, ], ycapm[1:41, ], matrix(Dout$ygivenx[ix, ], 41,41)), add=TRUE, col=ix)
ix <-8
contour(with(fpoutcapm8a10g3m2x, ycapm[1:41, ], ycapm[1:41, ], matrix(Dout$ygivenx[ix, ], 41,41)), add=TRUE, col=ix)
fpoutcapm8a10g3m2x$x
fpoutcapm8a10g3m2x$ygivenx[ , 1:10]
fpoutcapm8a10g3m2x$Dout$ygivenx[ , 1:10]
fpoutcapm8a10g3m2x$Dout$ygivenx %*% ycapm
contour(with(fpoutcapm8a10g3m2x, ycapm[1:41], ycapm[1:41], matrix(Dout$ygivenx[ix, ], 41,41)))
contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[1, ], 41,41))
for (ix in 2:8) contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[ix, ], 41,41), col=ix, add=TRUE)
contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[1, ], 41,41), nlevels=3)
for (ix in 2:8) contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[ix, ], 41,41), col=ix, add=TRUE, nlevels=3)
contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[1, ], 41,41), levels=1:3/1000)
for (ix in 2:8) contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[ix, ], 41,41), col=ix, add=TRUE, levels=1:3/1000)
contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[1, ], 41,41), levels=1:3/1000, col=7)
contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[1, ], 41,41), levels=1:3/1000, drawlabels=F)
apply(fpoutcapm8a10g3m2x$Dout$ygivenx, 1, range)
contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[1, ], 41,41), nlevels=3, drawlabels=T)
contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[1, ], 41,41), nlevels=4, drawlabels=T)
contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[1, ], 41,41), drawlabels=T)
help.start()
ygx <- fpoutcapm8a10g3m2x$Dout$ygivenx
ygxr <- apply(ygx, 1, range)
ygxlev <- matrix(0, 8, 5)
for (ix in 1:8) ygxlev[ix, ] <- seq(0, ygxr[ix,2], length=5)
0
ygx
ygxr
for (ix in 1:8) ygxlev[ix, ] <- seq(0, ygxr[2, ix], length=5)
ygxlev
ygxlev <- ygxlev[ , 2:4]
contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[1, ], 41,41), drawlabels=T, levels=ygxlev[1, ])
for (ix in 2:8) contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[ix, ], 41,41), col=ix, add=TRUE, levels=ygxlev[ix, ])
contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[1, ], 41,41), drawlabels=T, levels=ygxlev[1, ], drawlabels=FALSE)
contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[1, ], 41,41), levels=ygxlev[1, ], drawlabels=FALSE)
for (ix in 2:8) contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[ix, ], 41,41), col=ifelse(ix==7. 9, ix), add=TRUE, levels=ygxlev[ix, ], drawlabels=FALSE)
for (ix in 2:8) contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[ix, ], 41,41), col=ifelse(ix==7, 9, ix), add=TRUE, levels=ygxlev[ix, ], drawlabels=FALSE)
contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[2, ], 41,41), levels=ygxlev[2, ], drawlabels=FALSE)
for (ix in c(3,4,8)) contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[ix, ], 41,41), add=TRUE, levels=ygxlev[ix, ], drawlabels=FALSE)
for (ix in c(1,5,7)) contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[ix, ], 41,41), add=TRUE, col=2:4, levels=ygxlev[ix, ], drawlabels=FALSE)
contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[2, ], 41,41), levels=ygxlev[2, ], drawlabels=FALSE, ylab="Asset 1 yield", xlab="Asset 2 yield")
for (ix in c(3,4,8)) contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[ix, ], 41,41), add=TRUE, levels=ygxlev[ix, ], drawlabels=FALSE)
for (ix in c(1,5,7)) contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[ix, ], 41,41), add=TRUE, col=ix+1, levels=ygxlev[ix, ], drawlabels=FALSE)
contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[2, ], 41,41), levels=ygxlev[2, ], drawlabels=FALSE, ylab="Asset 1 yield", xlab="Asset 2 yield", xlim=c(0,.05), ylim=c(0,.05))
for (ix in c(1,5,7)) contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[ix, ], 41,41), add=TRUE, lty=ix+1, levels=ygxlev[ix, ], drawlabels=FALSE)
contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[2, ], 41,41), levels=ygxlev[2, ], drawlabels=FALSE, ylab="Asset 1 yield", xlab="Asset 2 yield", xlim=c(0,.05), ylim=c(0,.05))
lt <- 1; for (ix in c(1,5,7)) {lt <- lt+1; contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[ix, ], 41,41), add=TRUE, lty=lt, levels=ygxlev[ix, ], drawlabels=FALSE)
)
lt <- 1; for (ix in c(1,5,7)) {lt <- lt+1; contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[ix, ], 41,41), add=TRUE, lty=lt, levels=ygxlev[ix, ], drawlabels=FALSE)}
contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[2, ], 41,41), levels=ygxlev[2, ], drawlabels=FALSE, ylab="Asset 1 yield", xlab="Asset 2 yield", xlim=c(0,.05), ylim=c(0,.05))
contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[2, ], 41,41), levels=ygxlev[2, ], drawlabels=FALSE, ylab="Asset 1 yield", xlab="Asset 2 yield", lty=2)
for(ix in c(3,4,8)) contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[ix, ], 41,41), levels=ygxlev[ix, ], drawlabels=FALSE, add=TRUE,  lty=2)
for (ix in c(1,5,7)) contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[ix, ], 41,41), add=TRUE, levels=ygxlev[ix, ], drawlabels=FALSE)
contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[2, ], 41,41), levels=ygxlev[2, ], drawlabels=FALSE, ylab="Asset 1 yield", xlab="Asset 2 yield", lty=2, xlim=c(0,.05), ylim=c(0,.05))
for(ix in c(3,4,8)) contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[ix, ], 41,41), levels=ygxlev[ix, ], drawlabels=FALSE, add=TRUE,  lty=2)
for (ix in c(1,5,7)) contour( ycapm[1:41], ycapm[1:41], matrix(fpoutcapm8a10g3m2x$Dout$ygivenx[ix, ], 41,41), add=TRUE, levels=ygxlev[ix, ], drawlabels=FALSE)
dev.copy2pdf(file="capmg3m2contours.pdf")
ls(pattern="polar")
fpoutpolar12a1.5x$call
fpoutpolar10a1.5x$call
fpoutpolar10a1.5xx <- DiscFP(param =  c(10, rep(0.1, 9), rep(mean(x[,
1]), 10), 1:10 * 2 * pi/10)), gy = gpolar, y = ypolar, U = Upolar,
xfcn = xfcnpolar, alph = 1.5, nit = 1000, crit = 1e-05)
fpoutpolar10a1.5xx <- with(fpoutpolar10a1.5x, DiscFP(param =  c(10, rep(0.1, 9), rep(mean(x[,
1]), 10), 1:10 * 2 * pi/10)), gy = gpolar, y = ypolar, U = Upolar,
xfcn = xfcnpolar, alph = 1.5, nit = 1000, crit = 1e-05)
fpoutpolar10a1.5xx <- with(fpoutpolar10a1.5x, DiscFP(param =  c(10, rep(0.1, 9), rep(mean(x[,
1]), 10), 1:10 * 2 * pi/10), gy = gpolar, y = ypolar, U = Upolar,
xfcn = xfcnpolar, alph = 1.5, nit = 1000, crit = 1e-05))
fpoutpolar10a1.5x$Dout$obj
fpoutpolar10a1.5xx$Dout$obj
fpoutpolar10a1.5xx$Dout$itct
fpoutpolar10a1.5xx$itct
fpoutpolar10a1.5xx <- with(fpoutpolar10a1.5x, DiscFP(param =  c(10, rep(0.1, 9), rep(mean(x[,
1]), 10), 1:10 * 2 * pi/10), gy = gpolar, y = ypolar, U = Upolar,
xfcn = xfcnpolar, alph = 1.5, nit = 1000, crit = 1e-06))
fpoutpolar10a1.5xx$itct
fpoutpolar10a1.5xx$Dout$obj
print(fpoutpolar10a1.5xx$Dout$obj, digits=10)
print(fpoutpolar12a1.5x$Dout$obj, digits=10)
fpoutpolar12a1.5xx$x
fpoutpolar12a1.5x$x
fpoutpolar12a1.5x$Dout$pnew
fpoutpolar10a1.5xx$Dout$pnew
print(fpoutpolar10a1.5xx$Dout$obj)
print(fpoutpolar10a1.5xx$Dout$obj, digits=12)
print(fpoutpolar12a1.5x$Dout$obj, digits=12)
plot(ypolar[ , 2], fpoutpolar10a1.5$Dout$ygivenx[1, ])
ypolar[35:45, ]
ls(pattern="^g")
ls(pattern="ygx")
str(ygxt)
plot(ypolar[ seq(1,1681, by=41), 2], ygxt)
matplot(ypolar[ seq(1,1681, by=41), 2], ygxt)
matplot(ypolar[ seq(1,1681, by=41), 2], t(ygxt))
matplot(ypolar[ seq(1,1681, by=41), 2], t(ygxt), type="l")
matplot(ypolar[ seq(1,1681, by=41), 2], t(ygxt), type="l", lty=1)
matplot(ypolar[ seq(1,1681, by=41), 2], t(ygxt), type="l", lty=1:2, col=1)
fpoutpolar10a1.5xx$x
diff[fpoutpolar10a1.5xx$x[ , 2])
diff(fpoutpolar10a1.5xx$x[ , 2])
fpoutpolar10a1.5x$Dout$ygivenx %*% ypolar
diff(.Last.value[ , 2])
diff(sort(fpoutpolar10a1.5x$Dout$ygivenx %*% ypolar[ , 2]))
diff(sort(apply(fpoutpolar10a1.5x$Dout$ygivenx, 1, which.max) ))
sort(apply(fpoutpolar10a1.5x$Dout$ygivenx, 1, which.max) )
ypolar[ , 2][.Last.value]/(2 * pi)
ypolar[sort(apply(fpoutpolar10a1.5x$Dout$ygivenx, 1, which.max) ), 2]/(2 * pi)
ypolar[sort(apply(fpoutpolar10a1.5xx$Dout$ygivenx, 1, which.max) ), 2]/(2 * pi)
diff(.Last.value)
ypolar[sort(apply(fpoutpolar12a1.5x$Dout$ygivenx, 1, which.max) ), 2]/(2 * pi)
diff(.Last.value)
apply(ygxt, 1, which.max)
thet <- ypolar[seq(1, 1681, by=41), 2]
mod(-2,5)
-2 %% 5
that <- vector("numeric", 10)
that <- thet[apply(ygxt, 1, which.max)]
that
t2 <- ygxt %*% (abs(thet - that) %% pi)
t2 <- ygxt %*% (abs(outer(thet, that, "-")) %% pi)
t2
fpoutpolar12a1.5x$Dout$obj
print(fpoutpolar12a1.5x$Dout$obj, digits=12)
print(fpoutpolar10a1.5x$Dout$obj, digits=12)
print(fpoutpolar10a1.5xx$Dout$obj, digits=12)
str(ygxa)
range(ygxa)
range(fpoutpolar10a1.5xx$Dout$ygivenx)
range(fpoutpolar10a1.5xDout$ygivenx)
range(fpoutpolar10a1.5x$Dout$ygivenx)
ygxa <- array(ygx, c(10, 41,41))
ygxt <- apply(ygxa, c(1,3), sum)
ygxr <- apply(ygxa, 1:2, sum)
matplot(ypolar[ seq(1,1681, by=41), 2], t(ygxt), type="l", lty=1:2, col=1)
str(ygxt)
ygxa <- array(fpoutpolar10a1.5x$Dout$ygivenx, c(10, 41,41))
ygxt <- apply(ygxa, c(1,3), sum)
ygxr <- apply(ygxa, 1:2, sum)
matplot(ypolar[ seq(1,1681, by=41), 2], t(ygxt), type="l", lty=1:2, col=1)
that <- thet[apply(ygxt, 1, which.max)]
that <- thet[apply(ygxt, 1, which.max)]
t2 <- ygxt %*% (abs(outer(thet, that, "-")) %% pi)
t2
matplot(ypolar[ seq(1,1681, by=41), 2], t(ygxt), type="l", lty=1:2, col=1, ylab="marginal density ofsecond polar coordinate", xlab="Angle to x axis")
matplot(ypolar[ seq(1,1681, by=41), 2], t(ygxt), type="l", lty=1:2, col=1, ylab="marginal density of second polar coordinate", xlab="Angle to x axis")
matplot(ypolar[ seq(1,1681, by=41), 2], t(ygxt), type="l", lty=1:2, col=1, ylab="marginal density of second polar coordinate", xlab="Angle to positive x axis")
dev.copy2pdf(file="polar10a1.5Angle.pdf")
matplot(ypolar[ seq(1,1681, by=41), 2], t(ygxr), type="l", lty=1:2, col=1, ylab="marginal density of first polar coordinate", xlab="distance from 0")
matplot(ypolar[ seq(1,1681, by=41), 1], t(ygxr), type="l", lty=1:2, col=1, ylab="marginal density of first polar coordinate", xlab="distance from 0")
matplot(ypolar[ 1:41, 1], t(ygxr), type="l", lty=1:2, col=1, ylab="marginal density of first polar coordinate", xlab="distance from 0")
fpoutpolar10a1.5x$x
fpoutpolar12a1.5xx$x
fpoutpolar12a1.5x$x
ls(pattern="rec")
fpout2dr3c14a1.5$x
fpout2drec14a1.5$x
fpout2drec14a1.5$Dout$pnew
plot(fpout2drec14a1.5$x)
ls(pattern="^y")
contour( y2drec[1:41], y2drec[1:41], matrix(fpout2drec14a1.5$Dout$ygivenx[1, ], 41,41), drawlabels=FALSE, ylab="Y1", xlab="Y2", lty=2)
for (ix in c(2,3,5:7,9,10,14)) contour( y2drec[1:41], y2drec[1:41], matrix(fpout2drec14a1.5$Dout$ygivenx[ix, ], 41,41), drawlabels=FALSE lty=1:2, add=TRUE)
for (ix in c(2,3,5:7,9,10,14)) contour( y2drec[1:41], y2drec[1:41], matrix(fpout2drec14a1.5$Dout$ygivenx[ix, ], 41,41), drawlabels=FALSE, lty=1:2, add=TRUE)
contour( y2drec[1:41], y2drec[1:41], matrix(fpout2drec14a1.5$Dout$ygivenx[1, ], 41,41), drawlabels=FALSE, ylab="Y1", xlab="Y2", lty=2, nlevels=2)
for (ix in c(2,3,5:7,9,10,14)) contour( y2drec[1:41], y2drec[1:41], matrix(fpout2drec14a1.5$Dout$ygivenx[ix, ], 41,41), drawlabels=FALSE, lty=1:2, add=TRUE, nlevels=2)
contour( y2drec[1:41], y2drec[1:41], matrix(fpout2drec14a1.5$Dout$ygivenx[1, ], 41,41), drawlabels=FALSE, ylab="Y1", xlab="Y2", lty=2, nlevels=1)
for (ix in c(2,3,5:7,9,10,14)) contour( y2drec[1:41], y2drec[1:41], matrix(fpout2drec14a1.5$Dout$ygivenx[ix, ], 41,41), drawlabels=FALSE, lty=1:2, add=TRUE, nlevels=1)
contour( y2drec[1:41], y2drec[1:41], matrix(fpout2drec14a1.5$Dout$ygivenx[1, ], 41,41), drawlabels=FALSE, ylab="Y1", xlab="Y2", lty=2, nlevels=1)
for (ix in c(2,3,5:7,9,10,14)) contour( y2drec[1:41], y2drec[1:41], matrix(fpout2drec14a1.5$Dout$ygivenx[ix, ], 41,41), drawlabels=FALSE, add=TRUE, nlevels=1)
contour( y2drec[1:41], y2drec[1:41], matrix(fpout2drec14a1.5$Dout$ygivenx[1, ], 41,41), drawlabels=FALSE, ylab="Y1", xlab="Y2", lty=1:2, nlevels=2)
for (ix in c(2,3,5:7,9,10,14)) contour( y2drec[1:41], y2drec[1:41], matrix(fpout2drec14a1.5$Dout$ygivenx[ix, ], 41,41), drawlabels=FALSE, add=TRUE, nlevels=2, lty=1:2)
contour( y2drec[1:41], y2drec[1:41], matrix(fpout2drec14a1.5$Dout$ygivenx[1, ], 41,41), drawlabels=FALSE, ylab="Y1", xlab="Y2", lty=1:2, nlevels=2)
for (ix in c(2,3,5:7,9,11,14)) contour( y2drec[1:41], y2drec[1:41], matrix(fpout2drec14a1.5$Dout$ygivenx[ix, ], 41,41), drawlabels=FALSE, add=TRUE, nlevels=2, lty=1:2)
y2cdf <- with(fpout2drec14a1.5$Dout, cumsum(sort(ygivenx[1, ])/sum(ygivenx[1,])))
plot(y2cdf)
match(TRUE, y2cdf > .05)
sort(fpout2drec14a1.5$Dout$ygivenx[1, ])[1129]
contour( y2drec[1:41], y2drec[1:41], matrix(fpout2drec14a1.5$Dout$ygivenx[1, ], 41,41), drawlabels=FALSE, ylab="Y1", xlab="Y2", lty=1:2, levels=.00028269)
contour( y2drec[1:41], y2drec[1:41], matrix(fpout2drec14a1.5$Dout$ygivenx[1, ], 41,41), drawlabels=FALSE, ylab="Y1", xlab="Y2", lty=1:2, levels=.000141)
contour( y2drec[1:41], y2drec[1:41], matrix(fpout2drec14a1.5$Dout$ygivenx[3, ], 41,41), drawlabels=FALSE, ylab="Y1", xlab="Y2", lty=1:2, levels=.000141)
contour( y2drec[1:41], y2drec[1:41], matrix(fpout2drec14a1.5$Dout$ygivenx[3, ], 41,41), drawlabels=FALSE, ylab="Y1", xlab="Y2", lty=1:2, levels=.00007)
contour( y2drec[1:41], y2drec[1:41], matrix(fpout2drec14a1.5$Dout$ygivenx[1, ], 41,41), drawlabels=FALSE, ylab="Y1", xlab="Y2", lty=1:2, levels=.00007)
contour( y2drec[1:41], y2drec[1:41], matrix(fpout2drec14a1.5$Dout$ygivenx[1, ], 41,41), drawlabels=FALSE, ylab="Y1", xlab="Y2", lty=1:2, levels=.00004)
contour( y2drec[1:41], y2drec[1:41], matrix(fpout2drec14a1.5$Dout$ygivenx[1, ], 41,41), drawlabels=FALSE, ylab="Y1", xlab="Y2", lty=1:2, levels=.00002)
contour( y2drec[1:41], y2drec[1:41], matrix(fpout2drec14a1.5$Dout$ygivenx[1, ], 41,41), drawlabels=FALSE, ylab="Y1", xlab="Y2", lty=1:2, levels=.00001)
contour( y2drec[1:41], y2drec[1:41], matrix(fpout2drec14a1.5$Dout$ygivenx[1, ], 41,41), drawlabels=FALSE, ylab="Y1", xlab="Y2", lty=1:2, levels=.000005)
qf(.76, 5)
qchisq(.76, 5)
qchisq(.24, 5)
qchisq(.24, 5)/5
qchisq(.24, 6)/6
qchisq(.24, 4)/4
qchisq(.24, 3)/3
qchisq(.845, 4)
qchisq(.845, 4)/4
qchisq(.99,4)/4
qchisq(.844,4)/4
qchisq(.844,5)/5
qchisq(.844,3)/3
save.image()
getwd()
y
