ev <- eigen(sig)
ev$vectors
dimnames(ev$vectors) <- list(names(p1), NULL)
ev$vectors["testscr", ]
ev$vectors[,1]
rgvec
ev$vectors[,7]
str(rg)
summary(rg)
log(2) - 5/8
8*.Last.value
n <- 1:500
sum(2^(-n+1)/(n+2))
sum(3^(-n+1)/(n+2))
sum(10^(-n+1)/(n+2))
sum(.9^(-n+1)/(n+2))
sum((1/.9)^(-n+1)/(n+2))
sum((1/.9)^(-n)*2/(n+2))
a <- 2
a <- .5
sum(a^n*2/(n+2))
a <- .9
sum(a^n*2/(n+2))
sum(((1-a)/a) *a^n*2/(n+2))
a <- .99
sum(((1-a)/a) *a^n*2/(n+2))
a <- .1
sum(((1-a)/a) *a^n*2/(n+2))
sum((1-a)^(n-1)*a*2/(n+2))
a
a <- .9
sum((1-a)^(n-1)*a*2/(n+2))
sum((1-a)^(n-1)*a*1.5/(n+1.5))
sum((1-a)^(n-1)*a*1.5/(n+1))
a <- .1
sum((1-a)^(n-1)*a*1.5/(n+1))
a <- .6
sum((1-a)^(n-1)*a*1.5/(n+1))
a <- .61
sum((1-a)^(n-1)*a*1.5/(n+1))
a <- .64
sum((1-a)^(n-1)*a*1.5/(n+1))
a <- .6395
sum((1-a)^(n-1)*a*1.5/(n+1))
a <- .639
sum((1-a)^(n-1)*a*1.5/(n+1))
a <- .6389
sum((1-a)^(n-1)*a*1.5/(n+1))
a <- .638
sum((1-a)^(n-1)*a*1.5/(n+1))
a <- .6383
sum((1-a)^(n-1)*a*1.5/(n+1))
a <- .6385
sum((1-a)^(n-1)*a*1.5/(n+1))
a <- .6386
sum((1-a)^(n-1)*a*1.5/(n+1))
a <- .6387
sum((1-a)^(n-1)*a*1.5/(n+1))
log(.6387)
pi/.6367
pi/.6387
y
x <- seq(0,1, by=.01)
y <- sqrt(c/(x^2+1) - 1)
y <- sqrt(2/(x^2+1) - 1)
plot(x,y, type=:"l")
plot(x,y, type="l")
x <- seq(-1,1, by = .01)
y <- sqrt(2/(x^2+1) - 1)
plot(x, y, type="l")
plot(x, y, type="l", ylim=c(-1.1, 1.1))
lines(x, -y )
dev.copy2eps(file="Indept.eps")
getwd()
n
A <- diag(7) - matrix(1/7, 7,7)
eigen(A)
.Last.value$vectors[1,1]/.Last.value$vectors[2,1]
Omega <- toeplitz(}
rho<- .9
Omega <- toeplitz(c(1 - rho^8, rho * (1 - rho^6), rho^2 * ( 1 - rho^4), rho ^ 3 * ( 1 - rho^2)))/(1 - rho^2)
Omega
solve(Omega)
Omega <- toeplitz(c(1 - rho^8, rho * (1 - rho^6), rho^2 * ( 1 - rho^4), rho ^ 3 * ( 1 - rho^2)))/(1 - rho^2, 0, 0, 0,0)
Omega <- toeplitz(c(1 - rho^8, rho * (1 - rho^6), rho^2 * ( 1 - rho^4), rho ^ 3 * ( 1 - rho^2), 0, 0, 0,0))/(1 - rho^2)
solve(Omega)
chol(.Last.value)
Omega
rho + rho^3 + rho^5
rho^3 + rho^6
rho^3+rho^4
rho^4
rho0 <- .9
eta0 <- -.5
beta0 <- 1.3
sigeta0 <- .5
signu0 <- 1
sy <- matrix(0, 201, 2)
rm(eta0)
eta0 <- -.5
rm ( sigeta0)
sigeps0 <- .5
eps0 <- vector("numeric", 201)
for (it in 1:200) {}
for (it in 1:200) {
sy[it+1, 1] <- rho0 * sy[it, 1] + eps[it+1] + eta0 * eps[it]
sy[ it+1, 2] <- beta0 * s[it+1,1] + nu[it+1]
}
eps0[2:201] <- rnorm(200)*sigeps0
nu0 <- vector("numeric", 201)
nu0[2:201] <- rnorm(200) * signu0
for (it in 1:200) {
sy[it+1, 1] <- rho0 * sy[it, 1] + eps0[it+1] + eta0 * eps0[it]
sy[ it+1, 2] <- beta0 * s[it+1,1] + nu0[it+1]
}
for (it in 1:200) {
sy[it+1, 1] <- rho0 * sy[it, 1] + eps0[it+1] + eta0 * eps0[it]
sy[ it+1, 2] <- beta0 * sy[it+1,1] + nu0[it+1]
}
plot(ts(sy))
G <- matrix(c(rho0, eta0, 0, 0, 0, 0, 0,0,0), nrow=3, byrow=TRUE)
M <- matrix(c(1, 0, 1, 0, 0 , 1),nrow=3, byrow=TRUE)
H <- matrix(c(beta0, 0, 1), nrow=1)
M <- t(M)
shatmat <- matrix(0, 201, 3)
sigmat <- array(0, 201, 3,3)
sigmat <- array(0, c(201, 3,3))
lhmat <- matrix(0, 201, 2)
fcsterrmat <- vector("numeric", 201)
for (it in 2:201) {}
for (it in 2:201) {
kfout <- kf2(sy[it, 2], H, shatmat[it-1, ], sigmat[it-1, , ], G, M)
shatmat[it, ] <- kfout$shat
sigmat[it, , ] <- kfout$sig
lhmat[ it, ] <- kfout$lh
fcsterrmat[it] <- kfout$fcsterr
}
source('~/R/svnPrinceton/toolbox/Kalman/kf2.R')
for (it in 2:201) {
kfout <- kf2(sy[it, 2], H, shatmat[it-1, ], sigmat[it-1, , ], G, M)
shatmat[it, ] <- kfout$shat
sigmat[it, , ] <- kfout$sig
lhmat[ it, ] <- kfout$lh
fcsterrmat[it] <- kfout$fcsterr
}
plot(shatmat[ , 1], sy[ , 1])
cor(shatmat[ , 1], sy[ , 1])
apply(lhmat, 2, sum)
sum(lhmat)
rmultinom(5, c(.1, .2, .3, .4))
rmultinom(5, 10, c(.1, .2, .3, .4))
rep(1:4, times=.Last.value[,1])
source('~/Documents/teaching/Courses/ApplEmet13/pf.R')
source('~/Documents/teaching/Courses/ApplEmet13/pf.R')
pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[ , 2], nprtcl=10000)
source('~/Documents/teaching/Courses/ApplEmet13/pf.R')
pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[ , 2], nprtcl=10000)
source('~/Documents/teaching/Courses/ApplEmet13/pf.R')
pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[ , 2], nprtcl=10000)
source('~/Documents/teaching/Courses/ApplEmet13/pf.R')
pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[ , 2], nprtcl=10000)
source('~/Documents/teaching/Courses/ApplEmet13/pf.R')
pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[ , 2], nprtcl=10000)
source('~/Documents/teaching/Courses/ApplEmet13/pf.R')
rmultinom(1, 10, c(1:5,5:1)/30)
rep(1:10, times=.Last.value)
source('~/Documents/teaching/Courses/ApplEmet13/pf.R')
pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[ , 2], nprtcl=10000)
source('~/Documents/teaching/Courses/ApplEmet13/pf.R')
pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[ , 2], nprtcl=10000)
pfout <- pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[ , 2], nprtcl=10000)
hist(pfout$w)
pfout$lh
str(kfout)
sum(lhmat)
pfout <- pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[ , 2], nprtcl=10000)
pfout$lh
set.seed(50)
pfout <- pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[ , 2], nprtcl=10000)
pfout$lh
source('~/Documents/teaching/Courses/ApplEmet13/pf.R')
pfout <- pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[ , 2], nprtcl=10000)
pfout$lh
eta
eta0
sigeps0
signu0
source('~/Documents/teaching/Courses/ApplEmet13/pf.R')
source('~/Documents/teaching/Courses/ApplEmet13/pf.R')
pfout <- pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[ , 2], nprtcl=10000)
pfout$lh
hist(pfout$s1)
hist(pfout$s0)
hist(pfout$s1)
hist(pfout$w)
hist(log(pfout$w))
source('~/Documents/teaching/Courses/ApplEmet13/pf.R')
pfout <- pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[ , 2], nprtcl=10000)
plot(pfout$yhat, sy[-1, 2])
length(pfout$yhat)
pfout <- pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[-1 , 2], nprtcl=10000)
pfout$lh
plot(pfout$yhat, sy[-1, 2])
cor(pfout$yhat, sy[-1, 2])
source('~/Documents/teaching/Courses/ApplEmet13/pf.R')
pfout <- pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[-1 , 2], nprtcl=10000)
pfout$lh
cor(pfout$yhat, sy[-1, 2])
plot(pfout$yhat, sy[-1, 2])
source('~/Documents/teaching/Courses/ApplEmet13/pf.R')
pfout <- pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[-1 , 2], nprtcl=10000)
pfout$lh
cor(pfout$yhat, sy[-1, 2])
source('~/Documents/teaching/Courses/ApplEmet13/pf.R')
pfout <- pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[-1 , 2], nprtcl=10000)
source('~/Documents/teaching/Courses/ApplEmet13/pf.R')
pfout <- pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[-1 , 2], nprtcl=10000)
pfout$lh
cor(pfout$yhat, sy[-1, 2])
plot(pfout$yhat, sy[-1, 2])
mean(apply(fcsterrmat, 2, mean))
mean(fcsterrmat)
sd(fcsterrmat)
pffe <- sy[-1, 2] - yhat
pffe <- sy[-1, 2] - pfout$yhat
mean(pffe)
sd(pffe)
sum(pffe^2)
sum(fcsterrmat^2)
kffe <- sy[-1, 2] - shatmat %*% c(beta, 0, 1)
dim(shatmat)
kffe <- sy[-1, 2] - shatmat %*% c(beta0, 0, 1)
kffe <- sy[-1, 2] - shatmat[-1, ] %*% c(beta0, 0, 1)
mean(kffe)
source('~/Documents/teaching/Courses/ApplEmet13/pf.R')
pfout <- pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[-1 , 2], nprtcl=50000)
pfout$lh
pffe <- sy[-1, 2] - pfout$yhat
mean(pffe)
sd(pffe)
mean(fcsterrmat)
sd(fcsterrmat)
sum(fcsterrmat^2)
sum(pffe^2)
M <- matrix(c(.5, 0, .5, 0, 0, 1), nrows=3, byrow=TRUE)
M <- matrix(c(.5, 0, .5, 0, 0, 1), nrow=3, byrow=TRUE)
M <- t(M)
for (it in 2:201) {
kfout <- kf2(sy[it, 2], H, shatmat[it-1, ], sigmat[it-1, , ], G, M)
shatmat[it, ] <- kfout$shat
sigmat[it, , ] <- kfout$sig
lhmat[ it, ] <- kfout$lh
fcsterrmat[it] <- kfout$fcsterr
}
sum(lhmat)
mean(fcsterrmat)
sd(fcsterrmat)
sum(fcsterrmat^2)
dim(lhmat)
sum(lhmat[-1, ]) - 200 * .5 *log(2 * pi)
length(pffe)
pfout$lh
pfout <- pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[-1 , 2], nprtcl=10000)
pfout$lh
pfout <- pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[-1 , 2], nprtcl=10000)
pfout$lh
pfout <- pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[-1 , 2], nprtcl=10000)
pfout$lh
pfout <- pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[-1 , 2], nprtcl=10000)
pfout$lh
pfout <- pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[-1 , 2], nprtcl=10000)
pfout$lh
pfout <- pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[-1 , 2], nprtcl=10000)
pfout$lh
pfout <- pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[-1 , 2], nprtcl=50000)
pfout$lh
pfout <- pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[-1 , 2], nprtcl=50000)
pfout$lh
pfout <- pf(rho0, eta0, beta0, sigeps0, signu0, ydata=sy[-1 , 2], nprtcl=50000)
pfout$lh
save.image()
getwd()
source('~/Documents/teaching/Courses/ApplEmet13/kfTrans.R')
kftrans(G=matrix(c(.9, -.5, 0, 0), nrow=2, byrow=TRUE), M= .5, S=1)
kfTrans(G=matrix(c(.9, -.5, 0, 0), nrow=2, byrow=TRUE), M= .5, S=1)
kfTrans(G=matrix(c(.9, -.5, 0, 0), nrow=2, byrow=TRUE), M= .5, H=1.3, S=1)
source('~/Documents/teaching/Courses/ApplEmet13/kfTrans.R')
kfTrans(G=matrix(c(.9, -.5, 0, 0), nrow=2, byrow=TRUE), M= .5, H=1.3, S=1)
source('~/Documents/teaching/Courses/ApplEmet13/kfTrans.R')
kfTrans(G=matrix(c(.9, -.5, 0, 0), nrow=2, byrow=TRUE), M= .5, H=1.3, S=1)
source('~/Documents/teaching/Courses/ApplEmet13/kfTrans.R')
kfTrans(G=matrix(c(.9, -.5, 0, 0), nrow=2, byrow=TRUE), M= .5, H=1.3, S=1)
source('~/Documents/teaching/Courses/ApplEmet13/kfTrans.R')
kfTrans(G=matrix(c(.9, -.5, 0, 0), nrow=2, byrow=TRUE), M= .5, H=1.3, S=1)
M
ns
ny
Q
source('~/Documents/teaching/Courses/ApplEmet13/kfTrans.R')
Q
kfTrans(G=matrix(c(.9, -.5, 0, 0), nrow=2, byrow=TRUE), M= .5, H=1.3, S=1)
ns
ny
M
G
S
0
H
n
n
n
G
n
H
n
M
Q
kfTrans(G=matrix(c(.9, -.5, 0, 0), nrow=2, byrow=TRUE), M= diag(c(.5, 1), H=1.3, S=1)
}
kfTrans(G=matrix(c(.9, -.5, 0, 0), nrow=2, byrow=TRUE), M= diag(c(.5, 1)), H=1.3, S=1)
c
kfTrans(G=matrix(c(.9, -.5, 0, 0), nrow=2, byrow=TRUE), M= c(.5, 1), H=1.3, S=1)
c
source('~/Documents/teaching/Courses/ApplEmet13/kfTrans.R')
kfTrans(G=matrix(c(.9, -.5, 0, 0), nrow=2, byrow=TRUE), M= c(.5, 1), H=1.3, S=1)
source('~/Documents/teaching/Courses/ApplEmet13/kfTrans.R')
kfTrans(G=matrix(c(.9, -.5, 0, 0), nrow=2, byrow=TRUE), M= c(.5, 1), H=1.3, S=1)
source('~/Documents/teaching/Courses/ApplEmet13/kfTrans.R')
kfTrans(G=matrix(c(.9, -.5, 0, 0), nrow=2, byrow=TRUE), M= c(.5, 1), H=1.3, S=1)
source('~/Documents/teaching/Courses/ApplEmet13/kfTrans.R')
source('~/Documents/teaching/Courses/ApplEmet13/kfTrans.R')
kfTrans(G=matrix(c(.9, -.5, 0, 0), nrow=2, byrow=TRUE), M= c(.5, 1), H=1.3, S=1)
source('~/Documents/teaching/Courses/ApplEmet13/kfTrans.R')
kfTrans(G=matrix(c(.9, -.5, 0, 0), nrow=2, byrow=TRUE), M= c(.5, 1), H=1.3, S=1)
M
S
n
n
n
G
n
n
M
S
ny
nshock
Q
source('~/Documents/teaching/Courses/ApplEmet13/kfTrans.R')
kfTrans(G=matrix(c(.9, -.5, 0, 0), nrow=2, byrow=TRUE), M= c(.5, 1), H=1.3, S=1)
c
G
H
M
kfTrans(G=matrix(c(.9, -.5, 0, 0), nrow=2, byrow=TRUE), M= c(.5, .5), H=1.3, S=1)
c
source('~/Documents/teaching/Courses/ApplEmet13/kfTrans.R')
kfTrans(G=matrix(c(.9, -.5, 0, 0), nrow=2, byrow=TRUE), M= c(.5, .5), H=1.3, S=1)
kfTrans(G=matrix(c(.9, -.5, 0, 0), nrow=2, byrow=TRUE), M= c(.5, .5), H=c(1.3, 0), S=1)
source('~/Documents/teaching/Courses/ApplEmet13/kfTrans.R')
source('~/Documents/teaching/Courses/ApplEmet13/pf.copy.R')
getwd()
qbeta(.071, 24, 301)
23/323
qbeta(.0275, 24, 301)
qbeta(..975, 24, 301)
qbeta(.975, 24, 301)
.071 - .037
.071 + .037
qbeta(.0275, 23.5, 300.5)
qbeta(.975, 23.5, 300.5)
x <- seq(-1,1, length=400)
plot(x, dnorm(x-1) + dnorm(x+1))
plot(x, dnorm(x-1) + dnorm(x+1), type = "l")
x <- seq(-.1,.1, length=400)
plot(x, dnorm(x-1) + dnorm(x+1), type = "l")
x <- seq(-.01,.01, length=400)
plot(x, dnorm(x-1) + dnorm(x+1), type = "l")
x <- seq(-1, 1, length=400)
plot(x, log(dnorm(x-1) + dnorm(x+1)), type = "l")
x <- seq(-.01, 01, length=400)
plot(x, log(dnorm(x-1) + dnorm(x+1)), type = "l")
x <- seq(-.01, .01, length=400)
plot(x, log(dnorm(x-1) + dnorm(x+1)), type = "l")
x <- seq(-3, 3, length=400)
plot(x, log(dnorm(x-1) + dnorm(x+1)), type = "l")
x <- seq(-10, 10, length=400)
plot(x, log(dnorm(x-1) + dnorm(x+1)), type = "l")
x <- seq(-3,3, length=400)
A <- dnorm(x-1) + dnorm(x+1)
h <- 1 + sin(x)/2
g <- dnorm(x, sd=.5)
fgoh <- fft(g/h)
fp <- fgoh/fft(A)
str(fp)
plot(abs(fp))
ifp <- ifft(fp)
ifp <- fft(fp)
plot(ifp)
str(ifp)
range(fp)
range(abs(fp))
sum(fp == Inf)
sum(abs(fp) == Inf)
which(abs(fp) ==Inf)
range(abs(fft(A)))
which(abs(fft(A)) == 0)
pgamma(23,6)
pgamma(6,6)
qgamma(.99, 6)
getwd()
setwd("~/R/toolbox/svnPrinceton/")
setwd("./R/svnPrinceton/toolbox/RIplus/trunk/DiscreteX/")
list.files()
load("ObjX.RData")
lsf.str()
source('~/R/svnPrinceton/toolbox/RIplus/trunk/DiscreteX/DiscPObj.R')
source('~/R/svnPrinceton/toolbox/optimize/trunk/csminwelNew.R')
source('~/R/svnPrinceton/toolbox/optimize/trunk/csminit.R')
source('~/R/svnPrinceton/toolbox/optimize/trunk/numgrad.R')
source('~/R/svnPrinceton/toolbox/optimize/trunk/bfgsi.R')
args(csminwelNew)
source('~/R/svnPrinceton/toolbox/RIplus/trunk/DiscreteX/Umix.R')
csout <- csminwelNew(Umix, c(.5, -.2, .2), H0=1e-4 * diag(3), )
y <- seq(-2, 2, length=200)
gy <- dnorm(y -.5) + dnorm(y + .5)
gy <- gy/sum(gy)
csout <- csminwelNew(DiscPObj, c(.5, -.2, .2), H0= 1e-4 *diag(3), gy=gy, y=y, U=Umix, alph=1)
csout <- csminwelNew(DiscPObj, c(.5, -.2, .2), H0= 1e-4 *diag(3), gy=gy, y=y, U=Umix, alph=1, nit=20)
csout <- csminwelNew(DiscPObj, c(.3, -.1, .1), H0= 1e-4 *diag(3), gy=gy, y=y, U=Umix, alph=1, nit=20)
csout <- csminwelNew(DiscPObj, c(.3, -.1, .1), H0= 1e-4 *diag(3), gy=gy, y=y, U=Umix, alph=.1, nit=20)
csout <- csminwelNew(DiscPObj, c(.3, -.1, .1), H0= 1e-4 *diag(3), gy=gy, y=y, U=Umix, alph=10, nit=20)
csout <- csminwelNew(DiscPObj, c(.3, -.1, .1), H0= 1e-4 *diag(3), gy=gy, y=y, U=Umix, alph=100, nit=20)
gy <- dnorm(y -2) + dnorm(y + 2)
csout <- csminwelNew(DiscPObj, c(.3, -.1, .1), H0= 1e-4 *diag(3), gy=gy, y=y, U=Umix, alph=1, nit=20)
csout <- csminwelNew(DiscPObj, c(.3, -.1, .1), H0= 1e-4 *diag(3), gy=gy, y=y, U=Umix, alph=10, nit=20)
csout <- csminwelNew(DiscPObj, c(.3, -.1, .1), H0= 1e-4 *diag(3), gy=gy, y=y, U=Umix, alph=10, nit=40)
csout <- csminwelNew(DiscPObj, c(.3, .2, -.1, 0, .1), H0= 1e-4 *diag(5), gy=gy, y=y, U=Umix, alph=10, nit=40)
gy <- dnorm(y -.5, sd=2) + dnorm(y + .5, sd=2)
csout <- csminwelNew(DiscPObj, c(.3, .2, -.1, 0, .1), H0= 1e-4 *diag(5), gy=gy, y=y, U=Umix, alph=10, nit=40)
csout <- csminwelNew(DiscPObj, c(.3,  -.1, 0), H0= 1e-4 *diag(3), gy=gy, y=y, U=Umix, alph=10, nit=40)
csout <- csminwelNew(DiscPObj, c(.3,  -.1, 0), H0= 1e-4 *diag(3), gy=gy, y=y, U=Umix, alph=20, nit=40)
csout <- csminwelNew(DiscPObj, c(.3,  -.1, 0), H0= 1e-4 *diag(3), gy=gy, y=y, U=Umix, alph=100, nit=40)
csout <- csminwelNew(DiscPObj, c(.3, .2,  -.1, 0, .1), H0= 1e-4 *diag(5), gy=gy, y=y, U=Umix, alph=100, nit=40)
csout <- csminwelNew(DiscPObj, c(.3, .2,  -.1, 0, .1), H0= 1e-4 *diag(5), gy=gy, y=y, U=Umix, alph=200, nit=40)
csout <- csminwelNew(DiscPObj, c(.3, .2,  -.1, 0, .1), H0= 1e-4 *diag(5), gy=gy, y=y, U=Umix, alph=50, nit=40)
args(DiscPObjX)
DiscPObjX(csout$xh, gy, y, U=Umix, alph=50)
sum(gy)
gy <- gy/sum(gy)
DiscPObjX(csout$xh, gy, y, U=Umix, alph=50)
.Last.value$pnew
csout <- csminwelNew(DiscPObj, c(.3, .2,  -.1, 0, .1), H0= 1e-4 *diag(5), gy=gy, y=y, U=Umix, alph=50, nit=40)
csout <- csminwelNew(DiscPObj, c(.3, .2,  -.1, 0, .1), H0= 1e-4 *diag(5), gy=gy, y=y, U=Umix, alph=100, nit=40)
csout <- csminwelNew(DiscPObj, c(.3, -.1, 0, H0= 1e-4 *diag(3), gy=gy, y=y, U=Umix, alph=100, nit=40)
}
}
csout <- csminwelNew(DiscPObj, c(.3, -.1, 0), H0= 1e-4 *diag(3), gy=gy, y=y, U=Umix, alph=100, nit=40)
csout <- csminwelNew(DiscPObj, c(.3, -.1, 0), H0= 1e-4 *diag(3), gy=gy, y=y, U=Umix, alph=10, nit=40)
csout <- csminwelNew(DiscPObj, c(.3, -.1, 0), H0= 1e-4 *diag(3), gy=gy, y=y, U=Umix, alph=200, nit=40)
csout <- csminwelNew(DiscPObj, c(.3, -.1, 0), H0= 1e-4 *diag(3), gy=gy, y=y, U=Umix, alph=200, nit=40, crit = 1e-9)
csout <- csminwelNew(DiscPObj, c(.3, -.1, 0), H0= 1e-4 *diag(3), gy=gy, y=y, U=Umix, alph=2, nit=40, crit = 1e-9)
csout <- csminwelNew(DiscPObj, c(.3, -.1, 0), H0= 1e-4 *diag(3), gy=gy, y=y, U=Umix, alph=20, nit=40, crit = 1e-9)
csout <- csminwelNew(DiscPObj, c(.3, -.1, 0), H0= 1e-4 *diag(3), gy=gy, y=y, U=Umix, alph=10, nit=40, crit = 1e-9)
DiscPObjX(csout$xh, gy, y, U=Umix, alpha=10)
DiscPObjX(csout$xh, gy, y, U=Umix, alph=10)
source('~/R/svnPrinceton/toolbox/RIplus/trunk/DiscreteX/DiscPObjX.R')
DiscPObjX(csout$xh, gy, y, U=Umix, alph=10)
csout <- csminwelNew(DiscPObj, c(.3, -.1, 0), H0= 1e-4 *diag(3), gy=gy, y=y, U=Umix, alph=20, nit=40, crit = 1e-9)
DiscPObjX(csout$xh, gy, y, U=Umix, alph=20)
csout$xh
csout <- csminwelNew(DiscPObj, csout$xh, H0= 1e-4 *diag(3), gy=gy, y=y, U=Umix, alph=20, nit=40, crit = 1e-9)
dout <- DiscPObjX(csout$xh, gy, y, U=Umix, alph=20)
dout$Eloss
csout <- csminwelNew(DiscPObj, c(.3, .5, -.1, .5, 1), H0= 1e-4 *diag(5), gy=gy, y=y, U=Umix, alph=100, nit=40, crit = 1e-9)
dout <- DiscPObjX(csout$xh, gy, y, U=Umix, alph=100)
dout$Eloss
str(dout)
source('~/R/svnPrinceton/toolbox/RIplus/trunk/DiscreteX/DiscPObjX.R')
range(dout$h)
plot(g, dout$h)
plot(gy, dout$h)
plot(y, dout$h)
plot(y, dout$h, type="l")
plot(y,gy)
dout3C <- DiscPObjX(csout$xh, gy, y, U=Umix, alph=300)
csout <- csminwelNew(DiscPObj, c(.3, .5, -.1, .5, 1), H0= 1e-4 *diag(5), gy=gy, y=y, U=Umix, alph=300, nit=40, crit = 1e-9)
csout <- csminwelNew(DiscPObj, c(.3, .5, -.1, .5, 1), H0= 1e-4 *diag(5), gy=gy, y=y, U=Umix, alph=150, nit=40, crit = 1e-9)
y <- seq(-5, 5, length=200)
gy <- dnorm(y -.5, sd=2) + dnorm(y + .5, sd=2)
gy <- gy/sum(gy)
plot(y,gy, type="l")
y <- seq(-7, 7, length=200)
gy <- dnorm(y -.5, sd=2) + dnorm(y + .5, sd=2)
gy <- gy/sum(gy)
plot(y,gy, type="l")
y <- seq(-9, 9, length=200)
gy <- dnorm(y -.5, sd=2) + dnorm(y + .5, sd=2)
gy <- gy/sum(gy)
plot(y,gy, type="l")
csout <- csminwelNew(DiscPObj, c(.3, .5, -.1, .5, 1), H0= 1e-4 *diag(5), gy=gy, y=y, U=Umix, alph=150, nit=40, crit = 1e-9)
csout <- csminwelNew(DiscPObj, c(.3,  -.1, .1), H0= 1e-4 *diag(5), gy=gy, y=y, U=Umix, alph=150, nit=40, crit = 1e-9)
csout <- csminwelNew(DiscPObj, c(.3,  -.1, .1), H0= 1e-4 *diag(5), gy=gy, y=y, U=Umix, alph=10, nit=40, crit = 1e-9)
csout <- csminwelNew(DiscPObj, c(.3,  -.1, .1), H0= 1e-4 *diag(3), gy=gy, y=y, U=Umix, alph=10, nit=40, crit = 1e-9)
csout <- csminwelNew(DiscPObj, c(.3, .2,  -.1, .01, .1), H0= 1e-4 *diag(5), gy=gy, y=y, U=Umix, alph=10, nit=40, crit = 1e-9)
csout <- csminwelNew(DiscPObj, c(.3, .2, .2,  -.1, -.05, .05,  .1), H0= 1e-4 *diag(7), gy=gy, y=y, U=Umix, alph=10, nit=40, crit = 1e-9)
csout <- csminwelNew(DiscPObj, c(.3, .2, .2,  -.1, -.05, .05,  .1), H0= 1e-4 *diag(7), gy=gy, y=y, U=Umix, alph=4, nit=40, crit = 1e-9)
csout <- csminwelNew(DiscPObj, c(.3, .2, .2,  -.1, -.05, .05,  .1), H0= 1e-4 *diag(7), gy=gy, y=y, U=Umix, alph=4, nit=100, crit = 1e-9)
csout <- csminwelNew(DiscPObj, c(.3, .2, .2,  -.1, -.05, .05,  .1), H0= 1e-4 *diag(7), gy=gy, y=y, U=Umix, alph=10, nit=100, crit = 1e-9)
csout <- csminwelNew(DiscPObj, c(.3, .2, .2,  -.1, -.05, .05,  .1), H0= 1e-4 *diag(7), gy=gy, y=y, U=Umix, alph=8, nit=100, crit = 1e-9)
getwd()
save.image()
source('~/R/svnPrinceton/toolbox/RIplus/trunk/DiscreteX/DiscPObj.R')
