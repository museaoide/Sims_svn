Q
Omega2 <- zeros(21,21)
Omega2 <- matrix(0,21,21)
Omega2[1:4,1:4] <- Omega[1:4,1:4]
siout <- SigInit(Ait, Omega2, 100, mu0 <- c(0,0,0,0,1), Sig0=1e6*diag(c(1,1,1,1,0)))
1
Q
NOTE <- "Omega and Sig0 are being taken as nv*nlags+1 square"
Omega
Omega2
siout <- SigInit(Ait, Omega2, 100, mu0 <- c(0,0,0,0,1), Sig0=1e6*diag(c(rep(1,20),0)))
0
siout <- SigInit(Ait, Omega2, 100, mu0 <- c(rep(0,20),1), Sig0=1e6*diag(c(rep(1,20),0)))
str(siout)
eigen(siout$Pinv)$values
max(abs(Im(siout$v)))
diag(siout$v)
y
NOTE
Omega
siout <- SigInit(Ait, Omega2, 100, mu0 <- c(rep(0,20),1), Sig0=1e6*diag(c(rep(1,20),0)))
siout$vdiag
diag(siout$vdiag)
eigen(siout$v)
eigen(siout$v)$values
eigen(siout$vdiag)$values
eigen(siout$v[1:4,1:4])
var(ydata)
siout$Pinv[1:4,]
siout$mu
siout <- SigInit(Ait, Omega2, 100, mu0 <- c(rep(0,20),1), Sig0=1e6*diag(c(rep(1,20),0)))
siout$mu
t(siout$mu0) %*% (solve(siout$v, mu0)
)
siout$mu0 %*% solve(siout$v, mu0)
siout$mu0[1:20] %*% solve(siout$v[1:20,1:20], mu0[1:20])
siout$mu[1:20] %*% solve(siout$v[1:20,1:20], siout$mu[1:20])
ybar0 <- apply(ydata[1:5,],2,mean)
ybar0
siout$mu[1:4]
ybar20 <- rep(ybar0,5)
(ybar20 - siout$mu[1:20] %*% solve(siout$v[1:20,1:20], ybar20 - siout$mu[1:20])
}
(ybar20 - siout$mu[1:20]) %*% solve(siout$v[1:20,1:20], ybar20 - siout$mu[1:20])
(ybar20 -siout$mu[1:20])/sqrt(diag(siout$v))
(ybar20 -siout$mu[1:20])/sqrt(diag(siout$v)[1:20])
cov2cor(siout$v)
cov2cor(Re(siout$v))
ybar
ybar0
(ybar0 - siout$mu[1:4]) %*% solve(siout$v[1:4,1:4], ybar0-siout$mu[1:4])
(ybar0 - siout$mu[1:4])/sqrt(diag(Re(siout$v)))
(ybar0 - siout$mu[1:4])/sqrt(diag(Re(siout$v))[1:4])
dim(Ait)
solve(diag(4)-apply(itvarmdd$By,c(1,2),sum), itvarmdd$Bx)
y
help.start()
setdiff(c(1:5),c(3,2))
A
A <- matrix(c(2.5,2.4, .896,1, 1,0,0,0, 0,1,0,0, 0,0,0,1), nrow=4, byrow=TRUE) 
A
eigen(A)
A[1,2] <- -2.4
eigen(A)
 A
A[1,3] <- .898
eigen(A)
args(SigInit)
Omega <- diag(4)
Omega <- diag(c(1,0,0,0))
Sig0 <- diag(1e6,4,4)
Sig0
Sig0[4,4] <- 0
SigInit(A, Omega, T=100, Sig0)
lsf.str()
SigInit(A, Omega, T=100, Sig0)
SigInit(A, Omega, T=100, Sig0)
SigInit(A, Omega, T=100, Sig0=Sig0)
SigInit(A, Omega, T=100, Sig0=Sig0)
SigInit(A, Omega, T=100, Sig0=Sig0)
options(error=recover)
SigInit(A, Omega, T=100, Sig0=Sig0)
1
hix
z
ssndx
Q
SigInit(A, Omega, T=100, Sig0=Sig0)
SigInit(A, Omega, T=100, Sig0=Sig0, ssndx=4)
lambda <- seq(0,50,by=.1)
plot(lambda, lambda^5*exp(-42.5*lambda), type="l")
lambda <- seq(0,12,by=.05)
plot(lambda, lambda^5*exp(-42.5*lambda), type="l")
lambda <- seq(0,1,length=200)
plot(lambda, lambda^5*exp(-42.5*lambda), type="l")
plot(lambda, lambda^5*exp(-42.5*lambda), type="l", ylab="Likelihood", xlab="lambda",main="Problem 1a likelihood")
dev.copy2eps("Prob1alh.eps")
0
args(dev.copy2eps)
dev.copy2eps(file="Prob1alh.eps")
"
}
{)
"
getwd()
setwd("/home/chris/Documents/teaching/Courses/Times08")
lh <- lambda^5*exp(-42.5\lambda)/(exp(-2*lambda) - exp(-22*lambda))^5
lambda <- lambda[-1]
lh <- lambda^5*exp(-42.5*lambda)/(exp(-2*lambda) - exp(-22*lambda))^5
plot(lambda, lh, type="l", ylab="Likelihood", xlab="lambda",main="Problem 1a likelihood")
1/20^5
bet <- .001
pstr <- .5*bet^2 * exp(-bet * lambda) * lh
args(integrate)
pstr <- .5*bet^2 * lambda * exp(-bet * lambda) * lh
pstrk <- function(x) .5 * bet^2 * x^6 * exp(-(42.5+bet) * x)/(exp(-2*x)-exp(-22*x))^5
integrate(pstrk, 0, INF)
0
?integrate
integrate(pstrk, 0, Inf)
0
integrate(pstrk, 1e-6, Inf)
0
pstrk <- function(x) .5 * bet^2 * x^6 * exp(-(22.5+bet) * x)/(1-exp(-20*x))^5
integrate(pstrk, 1e-6, Inf)
log(.Last.value)
log(1.329400e-13)
pstrk <- function(x) .5 * bet^2 * x^6 * exp(-(22.5+bet) * x + 29.64888)/(1-exp(-20*x))^5
integrate(pstrk, 1e-6, Inf)
ek <- function(x)pstrk(x) * (1/x)
integrate(ek, 1e-6, Inf)
bet
bet <- .01
pstrk <- function(x) .5 * bet^2 * x^6 * exp(-(22.5+bet) * x + 29.64888)/(1-exp(-20*x))^5
integrate(ek, 1e-6, Inf)
pstrk <- function(x) .5 * bet^2 * x^6 * exp(-(22.5+bet) * x )/(1-exp(-20*x))^5
integrate(pstrk, 1e-6, Inf)
log(1.325826e-11)
pstrk <- function(x) .5 * bet^2 * x^6 * exp(-(22.5+bet) * x + 25.0464)/(1-exp(-20*x))^5
integrate(pstrk, 1e-6, Inf)
integrate(ek, 1e-6, Inf)
bet
bet <- .1
pstrk <- function(x) .5 * bet^2 * x^6 * exp(-(22.5+bet) * x + 25.0464)/(1-exp(-20*x))^5
integrate(pstrk, 1e-6, Inf)
log(97.35069)
pstrk <- function(x) .5 * bet^2 * x^6 * exp(-(22.5+bet) * x + 25.0464 -  4.57832)/(1-exp(-20*x))^5
integrate(pstrk, 1e-6, Inf)
integrate(ek, 1e-6, Inf)
n
